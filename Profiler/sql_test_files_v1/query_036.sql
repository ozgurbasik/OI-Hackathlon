
WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;

WITH recent_orders AS (
    SELECT customer_id, order_date
    FROM orders
    WHERE order_date > DATEADD(day, -30, GETDATE())
)
SELECT c.id, c.name, r.order_date
FROM customers c
JOIN recent_orders r ON c.id = r.customer_id
WHERE c.active = 1;
